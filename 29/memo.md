# LU分解

## 定義
- 行列を下三角、上三角行列の積で表現すること

## 基本的な手法
- 行列`A`を基本行列を用いて上三角行列`U`に変換する
    - `E_1E_2A = U`..など
- 基本行列に対する逆行列を左からかける
    - `A = E_2^{-1}E_1^{-1} U`
    - `E_2^{-1}E_1^{-1}`が上三角行列`L`となる
     - `別の行の定数倍を足す`基本行列は三角行列なので、基本行列を注意して定めることでその逆行列も上三角行列となる

## LDU分解
- `U`の対角成分は必ずしも1ではない
- 対角行列`D`を用いて`U`の対角成分を1にできる
```
U = DU'
```
- 最終的に`A = LDU`と分解できる

## PA=LU分解
- `E`（定数倍行加算の基本行列）のみで上三角にならないこともある（1,1要素が0など）
- `A`が可逆であれば`P`（行交換）行列を作用させたものについては必ずLU分解可能である
- `PA = LU`より`A = P^{-1}LU`
    - `P^{-1}`も置換行列なので改めて`P`とおいて`A = PLU`としてもよい

## LU分解を用いた一次方程式の解法
- `Ax = LUx = b`として解ける
- `Ux = c`として2回方程式を解く
    - `Lc = b`について、`L`が下三角なので`c`の第一要素から順番に代入して解ける
- O(n^2)で解ける（ガウス・ジョルダンはn^3）